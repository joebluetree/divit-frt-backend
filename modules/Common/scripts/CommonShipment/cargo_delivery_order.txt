CREATE TABLE IF NOT EXISTS cargo_delivery_order (
    do_id int4 generated by default as identity,
    do_cfno int NULL,
    do_category varchar(15) NULL,
    do_order_no varchar(30) NULL,
    do_order_date date NULL,
    do_parent_id int4 NULL,
    do_truck_id int4 NULL,
    do_truck_name varchar(60) NULL,
    do_truck_attn varchar(60) NULL,
    do_truck_tel varchar(60) NULL,
    do_truck_fax varchar(60) NULL,
    do_truck_cc varchar(60) NULL,
    do_pickup varchar(60) NULL,
    do_addr1 varchar(60) NULL,
    do_addr2 varchar(60) NULL,
    do_addr3 varchar(120) NULL,
    do_date date NULL,
    do_time varchar(15) NULL,
    do_attn varchar(60) NULL,
    do_tel varchar(60) NULL,
    do_from_id int4 NULL,
    do_from_name varchar(60) NULL,
    do_from_addr1 varchar(60) NULL,
    do_from_addr2 varchar(60) NULL,
    do_from_addr3 varchar(120) NULL,
    do_from_addr4 varchar(60) NULL,
    do_to_id int4 NULL,
    do_to_name varchar(60) NULL,
    do_to_addr1 varchar(60) NULL,
    do_to_addr2 varchar(60) NULL,
    do_to_addr3 varchar(120) NULL,
    do_to_addr4 varchar(60) NULL,

    do_uom1_id int4 NULL,
    do_desc1 varchar(100) NULL,
    do_tot_piece1 int NULL,
    do_wt1 numeric(14,3) NULL,
    do_cbm_cft1 numeric(14,3) NULL,
    do_uom2_id int4 NULL,
    do_desc2 varchar(60) NULL,
    do_tot_piece2 int NULL,
    do_wt2 numeric(14,3) NULL,
    do_cbm_cft2 numeric(14,3) NULL,
    do_uom3_id int4 NULL,
    do_desc3 varchar(60) NULL,
    do_tot_piece3 int NULL,
    do_wt3 numeric(14,3) NULL,
    do_cbm_cft3 numeric(14,3) NULL,
    do_uom4_id int4 NULL,
    do_desc4 varchar(60) NULL,
    do_tot_piece4 int NULL,
    do_wt4 numeric(14,3) NULL,
    do_cbm_cft4 numeric(14,3) NULL,

    do_remark_1 varchar(100) NULL,
    do_remark_2 varchar(100) NULL,
    do_remark_3 varchar(100) NULL,
    do_remark_4 varchar(100) NULL,
    do_danger_goods varchar(10) NULL,
    do_terms_ship varchar(10) NULL,
    do_vessel varchar(60) NULL,
    do_voyage varchar(15) NULL,

    do_freight varchar(60) NULL,
    do_export_doc varchar(60) NULL,
    do_is_delivery_sent varchar(1) NULL,
    do_delivery_date date NULL,

    rec_version int4 default 1 NOT NULL,
    rec_locked varchar(50) NULL,
    rec_created_by varchar(50) NULL,
    rec_created_date timestamptz NOT NULL,
    rec_edited_by varchar(50) NULL,
    rec_edited_date timestamptz NULL,
    rec_company_id int4 NOT NULL,
    rec_branch_id int4 NOT NULL,

    CONSTRAINT pk_cargo_delivery_order_do_id PRIMARY KEY (do_id)
);

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_parent_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_parent_id ON cargo_delivery_order USING btree (do_parent_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_truck_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_truck_id ON cargo_delivery_order USING btree (do_truck_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_from_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_from_id ON cargo_delivery_order USING btree (do_from_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_to_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_to_id ON cargo_delivery_order USING btree (do_to_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_uom1_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_uom1_id ON cargo_delivery_order USING btree (do_uom1_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_uom2_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_uom2_id ON cargo_delivery_order USING btree (do_uom2_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_uom3_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_uom3_id ON cargo_delivery_order USING btree (do_uom3_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_do_uom4_id') THEN
        CREATE INDEX ix_cargo_delivery_order_do_uom4_id ON cargo_delivery_order USING btree (do_uom4_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_rec_company_id') THEN
        CREATE INDEX ix_cargo_delivery_order_rec_company_id ON cargo_delivery_order USING btree (rec_company_id);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'ix_cargo_delivery_order_rec_branch_id') THEN
        CREATE INDEX ix_cargo_delivery_order_rec_branch_id ON cargo_delivery_order USING btree (rec_branch_id);
    END IF;
END $$;

SELECT setval(pg_get_serial_sequence('cargo_delivery_order', 'do_id'),
              COALESCE(MAX(do_id), 1),
              true)
FROM cargo_delivery_order;
