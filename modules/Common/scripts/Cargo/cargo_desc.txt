CREATE TABLE IF NOT EXISTS cargo_desc (
    desc_id int4 GENERATED BY DEFAULT AS IDENTITY,
    desc_parent_id int4 NOT NULL,
    desc_parent_type VARCHAR(50) NULL,
    desc_ctr int4 NULL,
    desc_mark VARCHAR(50) NULL,
    desc_package  VARCHAR(50) NULL,
    desc_description VARCHAR(50) NULL,
    
    rec_company_id int4 NOT NULL,
    rec_branch_id int4 NOT NULL,
    rec_created_by VARCHAR(50) NOT NULL,
    rec_created_date timestamptz NOT NULL,
    rec_edited_by VARCHAR(50) NULL,
    rec_edited_date timestamptz NULL,
    rec_locked VARCHAR(50) NULL,
    rec_version int4 DEFAULT 1 NULL,
    CONSTRAINT pk_cargo_desc_desc_id PRIMARY KEY (desc_id)
);

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'IX_cargo_desc_desc_parent_id') THEN
        CREATE INDEX "IX_cargo_desc_desc_parent_id" ON cargo_desc USING btree (desc_parent_id);
    END IF;
    
    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'IX_cargo_desc_rec_company_id') THEN
        CREATE INDEX "IX_cargo_desc_rec_company_id" ON cargo_desc USING btree (rec_company_id);
    END IF;
    
    IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE indexname = 'IX_cargo_desc_rec_branch_id') THEN
        CREATE INDEX "IX_cargo_desc_rec_branch_id" ON cargo_desc USING btree (rec_branch_id);
    END IF;
END $$;

SELECT setval(pg_get_serial_sequence('cargo_desc', 'desc_id'),
              COALESCE(MAX(desc_id), 1),
              true)
FROM cargo_desc;